---
import type { CollectionEntry } from 'astro:content';
import { formatDate } from '@utils/index';

interface Props {
  research: CollectionEntry<'research'>;
}

const { research } = Astro.props;
const { title, description, date, tags, image, imageAlt } = research.data;

// Default placeholder if no image
const displayImage = image || `https://placehold.co/800x450/e5e7eb/6b7280?text=${encodeURIComponent(title)}`;
const displayAlt = imageAlt || `${title} thumbnail`;
const base = import.meta.env.BASE_URL;
---

<article class="group h-full">
  <a
    href={`${base}research/${research.slug}`}
    class="block h-full border border-gray-100 rounded-lg overflow-hidden hover:-translate-y-1 hover:shadow-lg transition-all duration-300 bg-white"
  >
    <!-- Compact Image Thumbnail -->
    <div class="h-40 bg-gray-100 overflow-hidden">
      <img
        src={displayImage}
        alt={displayAlt}
        class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
        loading="lazy"
      />
    </div>

    <!-- Compact Content Section -->
    <div class="p-4">
      <!-- Title - Single Line -->
      <h3 class="text-lg font-bold text-gray-900 line-clamp-1 mb-1 group-hover:text-blue-600 transition-colors">
        {title}
      </h3>

      <!-- Description - Two Lines Max -->
      <p class="text-sm text-gray-600 line-clamp-2 mt-2 mb-3 leading-relaxed">
        {description}
      </p>

      <!-- Tags - Small Pills -->
      {tags.length > 0 && (
        <div class="flex flex-wrap gap-1.5 mb-3">
          {tags.slice(0, 3).map(tag => (
            <span class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded-full">
              {tag}
            </span>
          ))}
          {tags.length > 3 && (
            <span class="text-xs px-2 py-1 bg-gray-100 text-gray-400 rounded-full">
              +{tags.length - 3}
            </span>
          )}
        </div>
      )}

      <!-- Date - Bottom -->
      <time class="text-xs text-gray-400 block mt-auto" datetime={date.toISOString()}>
        {date.getFullYear()}
      </time>
    </div>
  </a>
</article>
